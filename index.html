<!DOCTYPE html>
<html>

<head>
    <base href="https://demos.telerik.com/kendo-ui/bar-charts/grouped-stacked-bar">
    <style>
        html {
            font-size: 14px;
            font-family: Arial, Helvetica, sans-serif;
        }
    </style>
    <title></title>
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2019.3.1023/styles/kendo.default-v2.min.css" />

    <script src="https://kendo.cdn.telerik.com/2019.3.1023/js/jquery.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2019.3.1023/js/kendo.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/canvasjs/1.7.0/jquery.canvasjs.min.js">     
    
    </script>
    <!-- <script type="text/javascript" src="Scripts/FileSaver.min.js"></script>
    <script type="text/javascript" src="Scripts/jszip.min.js"></script>
    <script type="text/javascript" src="Scripts/pptxgen.min.js"></script> -->
   


</head>

<body>
    <div id="example">
        <div class="demo-section k-content wide">
            <div id="chart"></div>
        </div>
        <div id="img-out"></div>
        <button id="exportAsPpt">
            Export As PPT
        </button>

        <!-- <div id="chartContainer" style="width: 100%; height: 360px;"></div>
<button id="exportAsPpt1">
  Export As PPT
</button> -->
        <script>
            function createChart() {
                $("#chart").kendoChart({
                    title: {
                        text: "World population by age group and sex"
                    },
                    legend: {
                        visible: false
                    },
                    seriesDefaults: {
                        type: "column"
                    },
                    series: [{
                        name: "0-19",
                        stack: "Female",
                        data: [854622, 925844, 984930, 1044982, 1100941, 1139797, 1172929, 1184435, 1184654]
                    }, {
                        name: "20-39",
                        stack: "Female",
                        data: [490550, 555695, 627763, 718568, 810169, 883051, 942151, 1001395, 1058439]
                    }, {
                        name: "40-64",
                        stack: "Female",
                        data: [379788, 411217, 447201, 484739, 395533, 435485, 499861, 569114, 655066]
                    }, {
                        name: "65-79",
                        stack: "Female",
                        data: [97894, 113287, 128808, 137459, 152171, 170262, 191015, 210767, 226956]
                    }, {
                        name: "80+",
                        stack: "Female",
                        data: [16358, 18576, 24586, 30352, 36724, 42939, 46413, 54984, 66029]
                    }, {
                        name: "0-19",
                        stack: "Male",
                        data: [900268, 972205, 1031421, 1094547, 1155600, 1202766, 1244870, 1263637, 1268165]
                    }, {
                        name: "20-39",
                        stack: "Male",
                        data: [509133, 579487, 655494, 749511, 844496, 916479, 973694, 1036548, 1099507]
                    }, {
                        name: "40-64",
                        stack: "Male",
                        data: [364179, 401396, 440844, 479798, 390590, 430666, 495030, 564169, 646563]
                    }, {
                        name: "65-79",
                        stack: "Male",
                        data: [74208, 86516, 98956, 107352, 120614, 138868, 158387, 177078, 192156]
                    }, {
                        name: "80+",
                        stack: "Male",
                        data: [9187, 10752, 13007, 15983, 19442, 23020, 25868, 31462, 39223]
                    }],
                    seriesColors: ["#cd1533", "#d43851", "#dc5c71", "#e47f8f", "#eba1ad",
                        "#009bd7", "#26aadd", "#4db9e3", "#73c8e9", "#99d7ef"],
                    valueAxis: {
                        labels: {
                            template: "#= kendo.format('{0:N0}', value / 1000) # M"
                        },
                        line: {
                            visible: false
                        }
                    },
                    categoryAxis: {
                        categories: [1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010],
                        majorGridLines: {
                            visible: false
                        }
                    },
                    tooltip: {
                        visible: true,
                        template: "#= series.stack #s, age #= series.name #"
                    }
                });
            }

            $(document).ready(createChart);
            $(document).bind("kendo:skinChange", createChart);
            //var canvas = createChart.canvas;
            //var dataURL = canvas.toDataURL();

            // $("#exportAsPpt").click(function (event) {
            //     console.log("Clicked!!")
            //     console.log(dataURL)
            // });

//             var chart = new CanvasJS.Chart("chartContainer", {
// 	title: {
//   	text: "Export Chart as PPT"
//   },
//   data: [
//     {
//       type: "column",
//       dataPoints: [
//         { x: 10, y: 71 },
//         { x: 20, y: 55 },
//         { x: 30, y: 50 },
//         { x: 40, y: 65 },
//         { x: 50, y: 95 },
//         { x: 60, y: 68 },
//         { x: 70, y: 28 },
//         { x: 80, y: 34 },
//         { x: 90, y: 14 }
//       ]
//     }					
//   ]
// });
// chart.render();
// var canvas = chart.canvas;
// var dataURL = canvas.toDataURL();
// console.log(`${canvas}`);

    //         $("#exportAsPpt").click(function() { 
    //     html2canvas($("#example"), {
    //         onrendered: function(canvas) {
    //             theCanvas = canvas;
    //             document.body.appendChild(canvas);

    //             // Convert and download as image 
    //             Canvas2Image.saveAsPNG(canvas); 
    //             $("#img-out").append(canvas);
    //             // Clean up 
    //             //document.body.removeChild(canvas);
    //         }
    //     });
    // });
        </script>
    </div>


</body>

</html>
